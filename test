//SpatialUtil.cs
        public static readonly Dictionary<int, int> ESRI_UNIT_MAP_TO_SR_UNIT = new Dictionary<int, int>

        {
            {(int)ArcGIS.Core.Geometry.UnitTypeCode.Meters, (int)ArcGIS.Core.Geometry.UnitTypeCode.Meters},
            {(int)ArcGIS.Core.Geometry.UnitTypeCode.Feet, (int)ArcGIS.Core.Geometry.UnitTypeCode.Feet},
            {(int)ArcGIS.Core.Geometry.UnitTypeCode.FeetUS, (int)ArcGIS.Core.Geometry.UnitTypeCode.FeetUS },
            {(int)ArcGIS.Core.Geometry.UnitTypeCode.Degrees, (int)ArcGIS.Core.Geometry.UnitTypeCode.Degrees},
            {(int)ArcGIS.Core.Geometry.UnitTypeCode.Kilometers,(int)ArcGIS.Core.Geometry.UnitTypeCode.Kilometers}
        };

        public static readonly Dictionary<int, int> SR_UNIT_TO_ESRI_UNIT_MAP = new Dictionary<int, int>       {

            {(int)ArcGIS.Core.Geometry.UnitTypeCode.Meters, (int)ArcGIS.Core.Geometry.UnitTypeCode.Meters},
            {(int)ArcGIS.Core.Geometry.UnitTypeCode.Feet, (int)ArcGIS.Core.Geometry.UnitTypeCode.Feet},
            {(int)ArcGIS.Core.Geometry.UnitTypeCode.FeetUS, (int)ArcGIS.Core.Geometry.UnitTypeCode.FeetUS },
            {(int)ArcGIS.Core.Geometry.UnitTypeCode.Degrees, (int)ArcGIS.Core.Geometry.UnitTypeCode.Degrees},
            {(int)ArcGIS.Core.Geometry.UnitTypeCode.Kilometers,(int)ArcGIS.Core.Geometry.UnitTypeCode.Kilometers}
        };
		
//MiscUtils
     * given the map unit returns page unit by region, if different
     * @param mapUnit of type esriUnits
     * @return regional expected page unit of type esriUnits
     */
        public static int GetPageUnitByRegion(int mapUnit)
        {

            //System.out.println(file_name + "GetPageUnitByRegion() " + "Map unit: " + mapUnit);

            int outUnit = -1;
            // TODO - fix this to get the active region from the dropdown value
            //
            //SDEManager sdeRef = SDEManager.getSDEManager(TimsGlobals.app);
            var current_region = BmRegionSelect.CurrentRegion;;  //todo - hook variable to region selected by Addin 
            string region = current_region.ToString(); 
            //sdeRef.getActiveRegion();
            // Get the active region from the view model
            // Possibly need to create a non-protected variable that returns region

            switch (mapUnit)
            {
                case (9102):
                    if (region.Equals(TimsConstants.alsKey, StringComparison.OrdinalIgnoreCase) || region.Equals(TimsConstants.atlKey, StringComparison.OrdinalIgnoreCase))
                        outUnit = (int)esriUnits.esriCentimeters;
                    else
                        outUnit = (int)esriUnits.esriInches;
                    break;
                case (9003):
                    if (region.Equals(TimsConstants.alsKey, StringComparison.OrdinalIgnoreCase) || region.Equals(TimsConstants.atlKey, StringComparison.OrdinalIgnoreCase))
                        outUnit = (int)esriUnits.esriCentimeters;
                    else
                        outUnit = (int)esriUnits.esriInches;
                    break;
                case (9002):
                    if (region.Equals(TimsConstants.alsKey, StringComparison.OrdinalIgnoreCase) || region.Equals(TimsConstants.atlKey, StringComparison.OrdinalIgnoreCase))
                        outUnit = (int)esriUnits.esriCentimeters;
                    else
                        outUnit = (int)esriUnits.esriInches;
                    break;
                case (9001):
                    if (region.Equals(TimsConstants.alsKey, StringComparison.OrdinalIgnoreCase) || region.Equals(TimsConstants.atlKey, StringComparison.OrdinalIgnoreCase))
                        outUnit = (int)esriUnits.esriCentimeters;
                    else
                        outUnit = (int)esriUnits.esriInches;
                    break;
            }
            return outUnit;
        } // end of method
		
        public static double DistanceConversion(double dist, int inUnit, int outUnit)
        {

            //System.out.println(file_name + "DistanceConversion() " + dist + ", "
            //        + inUnit + ", " + outUnit);

            //SpatialReferenceBuilder pSpatRefFact = null;
            //SpatialReference pSpatRefFact = null; 

            Unit pUnit = null;
            double inFactor = 0.0, outFactor = 0.0, outDist = 0.0;

            try
            {
                //pSpatRefFact =;

                if (outUnit == (int)ArcGIS.Core.Geometry.UnitTypeCode.Degrees)
                {
                    outFactor = TimsConstants.METERS_PER_DEGREE;
                }
                else
                {
                    //pUnit = pSpatRefFact.createUnit((int)outUnit);
                    pUnit = LinearUnit.CreateLinearUnit(outUnit); 

                    if (!(pUnit is LinearUnit))

                        outDist = -99999;

                    else
                        outFactor = pUnit.ConversionFactor;
                }


                // radians = degrees x pi/180
                // radians = s/r, where s equals arc length and r equals radius.
                // arc length is s = (radians) times r.
                // circle radius of 1 inch and 1 degree angle ==> s = 3.14159 / 180
                // * 1 = 0.01745327
                // each degree is about 0.0175 inches
                // one degree is 111194.8743 meter almost
                if (inUnit == (int)ArcGIS.Core.Geometry.UnitTypeCode.Degrees)
                {
                    inFactor = TimsConstants.METERS_PER_DEGREE;
                }
                else
                {
                    pUnit = LinearUnit.CreateLinearUnit(inUnit); //pSpatRefFact.createUnit((int)inUnit);
                    if (!(pUnit is LinearUnit))

                    outDist = -99999;

                else
                        inFactor = pUnit.ConversionFactor;
                }

            }
            //catch (UnknownHostException e)
            //{

            //    e.printStackTrace();
            ////}
            catch (IOException e)
            {

                Console.WriteLine(e.StackTrace);
            }

            outDist = dist * inFactor / outFactor;
            //System.out.println(file_name + "InFactor: " + inFactor
            //        + ", OutFactor: " + outFactor + ", outDist: " + outDist);

            //System.out.println(file_name + "DistanceConversion()..........\n");
            return outDist;

        } // end of method
		
        public static String getESRIUnit2Str(int inUnit)
        {

            String outUnits = null;
            //pass region variable through selected by Addin
            var current_region = BmRegionSelect.CurrentRegion;   
            string region = current_region.ToString();

            // get the current region from the view model 

            switch (inUnit)
            {
                //case - International Foot - LinearUnit.Feet
                case 9002: 
                    outUnits = MapLayoutConstants.RELATIVE_FEET;
                    break;
                // case - International Meter - LinearUnit.Meters
                case 9001: 
                    outUnits = MapLayoutConstants.RELATIVE_METER;
                    break;
                //case - US Survey Foot - LinearUnit.FeetUS
                case 9003:
                    outUnits = MapLayoutConstants.RELATIVE_FEET;
                    break;
                case 9102: // AngularUnit.Degrees.FactoryCode:
                    if (region.Equals(TimsConstants.alsKey, StringComparison.OrdinalIgnoreCase) || region.Equals(TimsConstants.atlKey, StringComparison.OrdinalIgnoreCase))
                        outUnits = MapLayoutConstants.RELATIVE_METER;
                    else if (region.Equals(TimsConstants.gulfKey, StringComparison.OrdinalIgnoreCase) || region.Equals(TimsConstants.pacKey, StringComparison.OrdinalIgnoreCase))
                        outUnits = MapLayoutConstants.RELATIVE_FEET;
                    break;
                default:
                    outUnits = MapLayoutConstants.RELATIVE_NOT_CALCULATED;
                    //TimsGlobals.BMLogger.log(Level.WARNING, outUnits);
                    break;
            }
            return outUnits;
        }
		
		        public static int SrUnitByRegion(int srmapUnit)
        {

            //System.out.println(file_name + "SrUnitByRegion() " + "SR Map unit: " + srmapUnit);
            var geographicSR = SpatialReferenceBuilder.CreateSpatialReference(4267);
            int outUnit = -1;
            // pass current region 
            var current_region = BmRegionSelect.CurrentRegion;;   
            string region = current_region.ToString();
            // DEBUG
            //MessageBox.Show($"SrUnitByRegion() - SR Map unit: {srmapUnit}, Region: {region}");

            switch (srmapUnit)
            {
                case (int)ArcGIS.Core.Geometry.UnitTypeCode.Degrees: //.CIM.esriUnits.esriDecimalDegrees:
                    if (region.Equals(TimsConstants.alsKey, StringComparison.OrdinalIgnoreCase) || region.Equals(TimsConstants.atlKey, StringComparison.OrdinalIgnoreCase))
                        outUnit = (int)ArcGIS.Core.Geometry.UnitTypeCode.Meters;   // use arcgis core geometry linear unit 
                    else
                        outUnit = (int)ArcGIS.Core.Geometry.UnitTypeCode.Feet; // adjusted from FeetUS to Feet since Intl Feet are preferred
                    break;
                case (int)ArcGIS.Core.Geometry.UnitTypeCode.FeetUS:
                    if (region.Equals(TimsConstants.alsKey, StringComparison.OrdinalIgnoreCase) || region.Equals(TimsConstants.atlKey, StringComparison.OrdinalIgnoreCase))
                        outUnit = (int)ArcGIS.Core.Geometry.UnitTypeCode.Meters;
                    else
                        outUnit = (int)ArcGIS.Core.Geometry.UnitTypeCode.FeetUS;
                    break;
                case (int)ArcGIS.Core.Geometry.UnitTypeCode.Feet:
                    if (region.Equals(TimsConstants.alsKey, StringComparison.OrdinalIgnoreCase) || region.Equals(TimsConstants.atlKey, StringComparison.OrdinalIgnoreCase))
                        outUnit = (int)ArcGIS.Core.Geometry.UnitTypeCode.Meters;
                    else
                        outUnit = (int)ArcGIS.Core.Geometry.UnitTypeCode.Feet;
                    break;
                case (int)ArcGIS.Core.Geometry.UnitTypeCode.Meters:
                    if (region.Equals(TimsConstants.alsKey, StringComparison.OrdinalIgnoreCase) || region.Equals(TimsConstants.atlKey, StringComparison.OrdinalIgnoreCase))
                        outUnit = (int)ArcGIS.Core.Geometry.UnitTypeCode.Meters;
                    else
                        outUnit = (int)ArcGIS.Core.Geometry.UnitTypeCode.Feet;
                    break;
            }
            return outUnit;
        } // end of method
