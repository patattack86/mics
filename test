Where to put debug statements in your file

In your layoutcomposer.cs, the critical camera/extent section is here (line numbers from your file):

1) Right after you compute the frame size + envelope

This is where you want to log the map frame aspect ratio.

Around lines 595–627 (right after frameEnvelope is created at ~624–626):

System.Diagnostics.Debug.WriteLine(
  $"[LAYOUT] page={pageWidth}x{pageHeight} basePageWidth={basePageWidth} " +
  $"frameEnvelope W={frameEnvelope.Width:0.###} H={frameEnvelope.Height:0.###} " +
  $"AR={frameEnvelope.Width / frameEnvelope.Height:0.####}"
);

2) Immediately before SetCamera(...)

Log the active view extent and its aspect ratio.

Right before line ~640 (before var ext = options.ActiveViewExtent;):

var av = MapView.Active;
var avExt = av?.Extent;

if (avExt != null)
{
  System.Diagnostics.Debug.WriteLine(
    $"[ACTIVE] extent W={avExt.Width:0.###} H={avExt.Height:0.###} " +
    $"AR={avExt.Width / avExt.Height:0.####} " +
    $"XMin={avExt.XMin:0.###} XMax={avExt.XMax:0.###} " +
    $"YMin={avExt.YMin:0.###} YMax={avExt.YMax:0.###}"
  );
}

3) Immediately after mapFrame.SetCamera(ext)

This is the most important one: log what camera Pro actually put on the map frame.

Right after line ~643 (right after mapFrame.SetCamera(ext);):

var mfCam = mapFrame.GetCamera();
if (mfCam != null)
{
  System.Diagnostics.Debug.WriteLine(
    $"[MAPFRAME] camera center=({mfCam.X:0.###},{mfCam.Y:0.###}) " +
    $"scale={mfCam.Scale:0.###} heading={mfCam.Heading:0.###} pitch={mfCam.Pitch:0.###}"
  );
}


If your SDK version exposes the extent from the camera (some patterns do, some don’t), also log it. If not available, the scale + center + AR comparison is still enough to diagnose the “fit expansion”.

4) Print the ratio mismatch explicitly

Right after both are known (after frameEnvelope and active extent exist):

if (avExt != null)
{
  var frameAR = frameEnvelope.Width / frameEnvelope.Height;
  var viewAR  = avExt.Width / avExt.Height;

  System.Diagnostics.Debug.WriteLine(
    $"[AR] frameAR={frameAR:0.####} viewAR={viewAR:0.####} diff={Math.Abs(frameAR - viewAR):0.####}"
  );
}
